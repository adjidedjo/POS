<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:html="http://www.w3.org/TR/REC-html40">
  <Worksheet ss:Name="Sheet1">
    <Table>
      <Row>
        <Cell><Data ss:Type="String">Channel Customer</Data></Cell>
        <Cell><Data ss:Type="String">Nama SPG/SPB</Data></Cell>
        <Cell><Data ss:Type="String">Status</Data></Cell>
        <Cell><Data ss:Type="String">No SO</Data></Cell>
        <Cell><Data ss:Type="String">SO Manual</Data></Cell>
        <Cell><Data ss:Type="String">Tanggal SO</Data></Cell>
        <Cell><Data ss:Type="String">Nama Konsumen</Data></Cell>
        <Cell><Data ss:Type="String">Kode Barang</Data></Cell>
        <Cell><Data ss:Type="String">Nama Barang</Data></Cell>
        <Cell><Data ss:Type="String">QTY</Data></Cell>
        <Cell><Data ss:Type="String">Price List</Data></Cell>
        <Cell><Data ss:Type="String">Tanggal Kirim</Data></Cell>
        <Cell><Data ss:Type="String">Netto Penjualan</Data></Cell>
        <Cell><Data ss:Type="String">Pembayaran Tunai</Data></Cell>
        <Cell><Data ss:Type="String">Netto Elite</Data></Cell>
        <Cell><Data ss:Type="String">Netto LAI</Data></Cell>
        <Cell><Data ss:Type="String">Netto Royal</Data></Cell>
        <Cell><Data ss:Type="String">Netto Serenity</Data></Cell>
        <Cell><Data ss:Type="String">Netto Technogel</Data></Cell>
        <Cell><Data ss:Type="String">Nama Bank</Data></Cell>
        <Cell><Data ss:Type="String">No Rekening</Data></Cell>
        <Cell><Data ss:Type="String">Jumlah Transfer</Data></Cell>
        <Cell><Data ss:Type="String">Nominal Kartu Debit</Data></Cell>
        <Cell><Data ss:Type="String">No Kartu Debit</Data></Cell>
        <Cell><Data ss:Type="String">Atas Nama</Data></Cell>
        <Cell><Data ss:Type="String">Nama Bank</Data></Cell>
        <Cell><Data ss:Type="String">Nominal Kartu Kredit</Data></Cell>
        <Cell><Data ss:Type="String">Nama Kartu Kredit</Data></Cell>
        <Cell><Data ss:Type="String">No Kartu Kredit</Data></Cell>
        <Cell><Data ss:Type="String">Atas Nama</Data></Cell>
        <Cell><Data ss:Type="String">No Merchant</Data></Cell>
        <Cell><Data ss:Type="String">Nama Merchant</Data></Cell>
        <Cell><Data ss:Type="String">Nominal Kartu Kredit</Data></Cell>
        <Cell><Data ss:Type="String">Nama Kartu Kredit</Data></Cell>
        <Cell><Data ss:Type="String">No Kartu Kredit</Data></Cell>
        <Cell><Data ss:Type="String">Atas Nama</Data></Cell>
        <Cell><Data ss:Type="String">No Merchant</Data></Cell>
        <Cell><Data ss:Type="String">Nama Merchant</Data></Cell>
        <Cell><Data ss:Type="String">Voucher</Data></Cell>
        <Cell><Data ss:Type="String">Sisa</Data></Cell>
        <Cell><Data ss:Type="String">Jenis Pembayaran</Data></Cell>
        <Cell><Data ss:Type="String">Kode Pameran</Data></Cell>
        <Cell><Data ss:Type="String">Dari Tanggal</Data></Cell>
        <Cell><Data ss:Type="String">Ke Tanggal</Data></Cell>
        <Cell><Data ss:Type="String">No Telp</Data></Cell>
        <Cell><Data ss:Type="String">Alamat Kirim</Data></Cell>
        <Cell><Data ss:Type="String">Kota</Data></Cell>
        <Cell><Data ss:Type="String">Email</Data></Cell>
        <Cell><Data ss:Type="String">Brand</Data></Cell>
        <Cell><Data ss:Type="String">Bonus</Data></Cell>
        <Cell><Data ss:Type="String">Taken</Data></Cell>
        <Cell><Data ss:Type="String">Serial</Data></Cell>
        <Cell><Data ss:Type="String">Verifikasi</Data></Cell>
      </Row>
      <% @b = ""  %>
    <% @sale_items.each do |sale_item| %>
      <Row>
        <% a = sale_item.sale.no_so %>
        <Cell><Data ss:Type="String"><%= sale_item.sale.channel_customer.nama %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.sales_promotion.nil? ? '' :
  sale_item.sale.sales_promotion.nama.titleize %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.cancel_order? ? 'Batal' : '-' %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.no_so %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.so_manual.present? ? sale_item.sale.so_manual : "-" %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.created_at.strftime("%Y-%m-%d") %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.pos_ultimate_customer.nama %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.kode_barang %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.nama_barang %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= sale_item.jumlah %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= sale_item.price_list %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.tanggal_kirim %></Data></Cell>
        <% if @b.blank? || @b != a %>
          <Cell><Data ss:Type="Number"><%= sale_item.sale.netto %></Data></Cell>
          <Cell><Data ss:Type="Number"><%= sale_item.sale.pembayaran %></Data></Cell>
          <Cell><Data ss:Type="Number"><%= sale_item.sale.netto_elite %></Data></Cell>
          <Cell><Data ss:Type="Number"><%= sale_item.sale.netto_lady %></Data></Cell>
          <Cell><Data ss:Type="Number"><%= sale_item.sale.netto_royal %></Data></Cell>
          <Cell><Data ss:Type="Number"><%= sale_item.sale.netto_serenity %></Data></Cell>
          <Cell><Data ss:Type="Number"><%= sale_item.sale.netto_tech %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.bank_account.nil? ? '-' : sale_item.sale.bank_account.name %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.bank_account.nil? ? '-' : sale_item.sale.bank_account.account_number %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= sale_item.sale.jumlah_transfer %></Data></Cell>
        <% else %>
          <Cell><Data ss:Type="Number">0</Data></Cell>
          <Cell><Data ss:Type="Number">0</Data></Cell>
          <Cell><Data ss:Type="Number">0</Data></Cell>
          <Cell><Data ss:Type="Number">0</Data></Cell>
          <Cell><Data ss:Type="Number">0</Data></Cell>
          <Cell><Data ss:Type="Number">0</Data></Cell>
          <Cell><Data ss:Type="Number">0</Data></Cell>
          <Cell><Data ss:Type="String">-</Data></Cell>
          <Cell><Data ss:Type="String">-</Data></Cell>
          <Cell><Data ss:Type="Number">0</Data></Cell>
        <% end %>
        <% sale_item.sale.payment_with_debit_cards.each do |cd| %>
          <% if @b.blank? || @b != a %>
            <Cell><Data ss:Type="Number"><%= cd.jumlah %></Data></Cell>
            <Cell><Data ss:Type="String"><%= cd.no_kartu_debit.present? ? cd.no_kartu_debit : '-'  %></Data></Cell>
            <Cell><Data ss:Type="String"><%= cd.atas_nama.present? ? cd.atas_nama : '-' %></Data></Cell>
            <Cell><Data ss:Type="String"><%= cd.nama_kartu.present? ? cd.nama_kartu : '-' %></Data></Cell>
          <% else %>
            <Cell><Data ss:Type="Number">0</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
          <% end %>
        <% end %>
        <% sale_item.sale.payment_with_credit_cards.each do |cc| %>
          <% if @b.blank? || @b != a %>
            <Cell><Data ss:Type="Number"><%= cc.jumlah %></Data></Cell>
            <Cell><Data ss:Type="String"><%= cc.nama_kartu.present? ? cc.nama_kartu : '-' %> </Data></Cell>
            <Cell><Data ss:Type="String"><%= cc.no_kartu_kredit.present? ? cc.no_kartu_kredit : '-' %> </Data></Cell>
            <Cell><Data ss:Type="String"><%= cc.atas_nama.present? ? cc.atas_nama : '-' %> </Data></Cell>
            <Cell><Data ss:Type="String"><%= cc.no_merchant.present? ? cc.no_merchant : '-' %> </Data></Cell>
            <Cell><Data ss:Type="String"><%= cc.nama_merchant.present? ? cc.nama_merchant : '-' %> </Data></Cell>
          <% else %>
            <Cell><Data ss:Type="Number">0</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
          <% end %>
        <% end %>
          <% if @b.blank? || @b != a %>
            <Cell><Data ss:Type="Number"><%= sale_item.sale.voucher %></Data></Cell>
            <Cell><Data ss:Type="Number"><%= sale_item.sale.sisa %></Data></Cell>
            <Cell><Data ss:Type="String"><%= sale_item.sale.tipe_pembayaran %></Data></Cell>
          <% else %>
            <Cell><Data ss:Type="Number">0</Data></Cell>
            <Cell><Data ss:Type="String">0</Data></Cell>
            <Cell><Data ss:Type="String">-</Data></Cell>
          <% end %>
        <Cell><Data ss:Type="String"><%= sale_item.sale.channel_customer.kode_channel_customer %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.channel_customer.dari_tanggal %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.channel_customer.sampai_tanggal %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.pos_ultimate_customer.no_telepon %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.pos_ultimate_customer.alamat %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.pos_ultimate_customer.kota %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.pos_ultimate_customer.email %></Data></Cell>
        <Cell><Data ss:Type="String"><%= Brand.find(sale_item.brand_id).brand %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.bonus? ? "BONUS" : "-" %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.taken? ? "Yes" : "No" %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.serial %></Data></Cell>
        <Cell><Data ss:Type="String"><%= sale_item.sale.validated? ? "Sudah" : "Belum"%></Data></Cell>
      </Row>
      <% @b = a %>
    <% end %>
    </Table>
  </Worksheet>
</Workbook>